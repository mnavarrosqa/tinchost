<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Setup wizard â€“ Tinchost Panel</title>
  <style>
    * { box-sizing: border-box; }
    body { font-family: system-ui, sans-serif; margin: 0; background: #f5f5f5; }
    .nav { background: #222; color: #fff; padding: 0.75rem 1.5rem; }
    .nav a { color: #fff; text-decoration: none; margin-right: 1rem; }
    main { max-width: 720px; margin: 0 auto; padding: 1.5rem; background: #fff; min-height: 80vh; }
    .risk { background: #f8d7da; border-left: 4px solid #dc3545; padding: 0.75rem; margin: 1rem 0; }
    pre { background: #f0f0f0; padding: 1rem; overflow-x: auto; }
    input, select { padding: 0.5rem; margin: 0.25rem 0.5rem 0.25rem 0; }
    button, .btn { padding: 0.5rem 1rem; cursor: pointer; background: #007bff; color: #fff; border: none; border-radius: 4px; }
  </style>
</head>
<body>
  <nav class="nav">
    <a href="/">Dashboard</a>
    <a href="/wizard">Wizard</a>
    <span style="float:right"><a href="/auth/logout">Logout</a></span>
  </nav>
  <main>
    <h1>Setup wizard</h1>
    <p>Install the stack step by step. Run the commands below on this server (e.g. via SSH), then click Verify or Next.</p>

    <% if (step === 'welcome' || !step) { %>
    <p>Welcome. Choose which PHP versions you want to install (e.g. 8.2, 8.3).</p>
    <form method="post" action="/wizard/php">
      <label><input type="checkbox" name="versions" value="8.1"> PHP 8.1</label><br>
      <label><input type="checkbox" name="versions" value="8.2" checked> PHP 8.2</label><br>
      <label><input type="checkbox" name="versions" value="8.3"> PHP 8.3</label><br>
      <p>On Ubuntu/Debian run (as root):</p>
      <pre>add-apt-repository -y ppa:ondrej/php
apt update
apt install -y php8.2-fpm php8.2-mysql php8.2-curl php8.2-mbstring php8.2-xml php8.2-zip</pre>
      <button type="submit">Next: Web server</button>
    </form>
    <% } %>

    <% if (step === 'web_server') { %>
    <p>Nginx is already used for the panel. It will also serve your sites. No extra install needed.</p>
    <p><a href="/wizard/step/database" class="btn">Next: Database</a></p>
    <% } %>

    <% if (step === 'database') { %>
    <p>Choose MySQL or MariaDB. Run the install on the server, then store the root password in Settings if you want the panel to create DBs.</p>
    <form method="post" action="/wizard/database">
      <label><input type="radio" name="choice" value="mysql" checked> MySQL 8</label>
      <label><input type="radio" name="choice" value="mariadb"> MariaDB 10</label><br>
      <pre># MySQL: apt install -y mysql-server
# MariaDB: apt install -y mariadb-server
# Then: mysql_secure_installation</pre>
      <button type="submit">Next: Email (optional)</button>
    </form>
    <% } %>

    <% if (step === 'email') { %>
    <p>Optional: Postfix + Dovecot for mail. Run on server:</p>
    <pre>apt install -y postfix dovecot-core dovecot-imapd dovecot-lmtpd</pre>
    <p><a href="/wizard/step/ftp" class="btn">Next: FTP (optional)</a></p>
    <% } %>

    <% if (step === 'ftp') { %>
    <p>Optional: ProFTPD for FTP access to site docroots.</p>
    <pre>apt install -y proftpd-basic</pre>
    <p><a href="/wizard/step/certbot" class="btn">Next: Certbot (optional)</a></p>
    <% } %>

    <% if (step === 'certbot') { %>
    <p>Optional: Certbot for Let's Encrypt SSL.</p>
    <pre>apt install -y certbot python3-certbot-nginx</pre>
    <form method="post" action="/wizard/complete">
      <button type="submit">Finish wizard</button>
    </form>
    <% } %>

    <% if (step === 'finish') { %>
    <p>Wizard complete. You can change paths in Settings.</p>
    <p><a href="/" class="btn">Go to dashboard</a></p>
    <% } %>
  </main>
</body>
</html>
